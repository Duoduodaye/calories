<!-- pages/index/index.wxml -->
<view class="container">
  
  <!-- æ—¥æœŸæ˜¾ç¤º -->
  <view class="card">
    <view class="flex-between mb-10">
      <text class="text-muted">ä»Šæ—¥æ‘„å…¥</text>
      <text class="text-muted">{{ todayDate }}</text>
    </view>
    
    <!-- çƒ­é‡æ€»è§ˆ -->
    <view class="calorie-summary">
      <view class="calorie-main">
        <text class="calorie-current">{{ todayCalories }}</text>
        <text class="calorie-unit"> / {{ dailyGoal }} åƒå¡</text>
      </view>
      
      <!-- çƒ­é‡è¿›åº¦æ¡ -->
      <view class="progress mt-10">
        <view class="progress-bar {{ progressClass }}" style="width: {{ progressPercent }}%"></view>
      </view>
      
      <!-- çƒ­é‡è¯¦ç»†ä¿¡æ¯ -->
      <view class="calorie-details mt-10">
        <view class="calorie-item">
          <text class="calorie-label">æ‘„å…¥</text>
          <text class="calorie-value intake">+{{ todayCalories }}</text>
        </view>
        <view class="calorie-item">
          <text class="calorie-label">æ¶ˆè€—</text>
          <text class="calorie-value burn">-{{ todayExerciseCalories }}</text>
        </view>
        <view class="calorie-item balance">
          <text class="calorie-label">çƒ­é‡å·®</text>
          <text class="calorie-value {{ calorieBalance > 0 ? 'positive' : calorieBalance < 0 ? 'negative' : '' }}">
            {{ calorieBalance > 0 ? '+' : '' }}{{ calorieBalance }}
          </text>
        </view>
      </view>
      
      <view class="calorie-status mt-10">
        <text class="text-muted">å‰©ä½™ {{ remainingCalories }} åƒå¡</text>
      </view>
    </view>
  </view>
  
  <!-- é¤æ¬¡æ¦‚è§ˆ -->
  <view class="meal-overview">
    <view wx:for="{{ mealData }}" wx:key="type" class="card meal-card {{ item.isMainMeal ? 'main-meal' : 'snack-meal' }}" bindtap="navigateToRecord" data-meal="{{ item.type }}">
      <view class="flex-between">
        <view class="meal-info">
          <text class="meal-name">{{ item.name }}</text>
          <text class="meal-calories">{{ item.calories }} åƒå¡</text>
          <view wx:if="{{ !item.isMainMeal }}" class="snack-label">
            <text class="snack-tag">åŠ é¤</text>
          </view>
        </view>
        <view class="meal-action">
          <text class="add-icon">+</text>
        </view>
      </view>
      
      <!-- é£Ÿç‰©åˆ—è¡¨ -->
      <view wx:if="{{ item.foods.length > 0 }}" class="food-list mt-10">
        <view wx:for="{{ item.foods }}" wx:for-item="food" wx:key="id" class="food-item">
          <text class="food-name">{{ food.foodName }}</text>
          <text class="food-weight">{{ food.weight }}g</text>
          <text class="food-calories">{{ food.calories }}åƒå¡</text>
        </view>
      </view>
      
      <view wx:else class="empty-meal">
        <text class="text-muted">ç‚¹å‡»æ·»åŠ é£Ÿç‰©</text>
      </view>
    </view>
  </view>

  <!-- è¿åŠ¨æ¦‚è§ˆ -->
  <view class="card exercise-overview" bindtap="addExercise">
    <view class="flex-between mb-10">
      <text class="exercise-title">ğŸƒâ€â™‚ï¸ ä»Šæ—¥è¿åŠ¨</text>
      <text class="exercise-total">{{ todayExerciseCalories }} åƒå¡</text>
    </view>
    
    <view wx:if="{{ exerciseData.length > 0 }}" class="exercise-list">
      <view wx:for="{{ exerciseData }}" wx:key="id" class="exercise-item">
        <text class="exercise-icon">{{ item.icon }}</text>
        <text class="exercise-name">{{ item.exerciseName }}</text>
        <text class="exercise-duration">{{ item.duration }}åˆ†é’Ÿ</text>
        <text class="exercise-calories">{{ item.caloriesBurned }}åƒå¡</text>
      </view>
    </view>
    
    <view wx:else class="empty-exercise">
      <text class="text-muted">ç‚¹å‡»æ·»åŠ è¿åŠ¨è®°å½•</text>
    </view>
  </view>
  
  <!-- å¿«é€Ÿæ·»åŠ æŒ‰é’® -->
  <view class="quick-add">
    <button class="btn-primary" bindtap="quickAdd">å¿«é€Ÿè®°å½•</button>
  </view>
  
</view>